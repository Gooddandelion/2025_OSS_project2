<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>22100324's form1</title>
  <style>
  :root{
    --bg: #0f1115;          /* 전체 배경 */
    --card: #1b1f26;        /* 폼 카드 */
    --card-2:#1f2430;
    --line:#2a2f39;         /* 테두리 */
    --text:#e7e9ee;         /* 본문 텍스트 */
    --sub:#9aa3b2;          /* 서브 텍스트 */
    --muted:#6b7280;        /* 플레이스홀더 */
    --green:#03c75a;        /* NAVER 그린 */
    --green-2:#11d368;
    --danger:#d93025;
    --focus:#3b82f6;        /* 포커스 보더 */
    --radius:12px;
    --gap:14px;
    --input-h:52px;
    --shadow: 0 10px 30px rgba(0,0,0,.35);
  }

  /* 기본 리셋 & 타이포 */
  *{ box-sizing:border-box; }
  html,body{ height:100%; }
  body{
    margin:0; background:var(--bg); color:var(--text);
    font: 16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, Apple SD Gothic Neo, sans-serif;
    -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
  }
  a{ color:inherit; text-decoration:none; }

  /* 레이아웃 */
  .inner{
    max-width: 980px; margin: 48px auto; padding: 0 20px;
  }
  .logo{ margin: 0 0 28px 0; }
  .logo .link{
    display:inline-block; font-weight: 800; letter-spacing:.5px;
    color: var(--green); font-size: 34px; font: Arial;
  }

  /* 카드 */
  .content{
    display:flex; justify-content:center;
  }
  .form{
    width: 520px;
    background: var(--card);
    border: 1px solid var(--line);
    border-radius: 16px;
    padding: 22px;
    box-shadow: var(--shadow);
  }
  .form_section{ display:grid; gap:22px; }
  .form_list{ display:grid; gap: var(--gap); }

  /* 토글(실명 인증된 아이디로 가입) */
  .join_toggle{
    display:flex; align-items:center; gap:10px; color:var(--sub);
  }
  .join_toggle input[type="checkbox"]{
    appearance:none; width:22px; height:22px; border-radius:6px;
    border:1.5px solid var(--line); background:var(--card-2); position:relative; cursor:pointer;
  }
  .join_toggle input[type="checkbox"]:checked{
    border-color:var(--green); background:rgba(3,199,90,.15);
  }
  .join_toggle input[type="checkbox"]:checked::after{
    content:""; position:absolute; inset:4px;
    background: var(--green); clip-path: polygon(14% 54%, 0 68%, 36% 100%, 100% 28%, 86% 14%, 36% 76%);
    border-radius:2px;
  }

  /* 입력 공통 */
  .form_item{ display:grid; gap:8px; }
  label{ color:#cbd5e1; font-size:14px; }
  input.input, select.input, textarea.input{
    width:100%; height: var(--input-h);
    color: var(--text); background: var(--card-2);
    border:1px solid var(--line); border-radius: var(--radius);
    padding: 0 14px; outline: none;
    transition: border-color .15s ease, box-shadow .15s ease, background .15s ease;
  }
  textarea.input{ min-height:120px; padding:12px 14px; resize: vertical; }
  input::placeholder, textarea::placeholder{ color:var(--muted); }

  input.input:focus, select.input:focus, textarea.input:focus{
    border-color: var(--green);
    box-shadow: 0 0 0 3px rgba(3,199,90,.18);
  }

  /* @naver.com 뱃지 */
  #divId .id_naver{
    margin-left:8px; padding:6px 10px; border-radius:10px;
    background:#12151b; border:1px solid var(--line); color:#9fb0c3; white-space:nowrap; font-size:13px;
  }
  #divId > div{ display:flex; align-items:center; }

  /* 비밀번호 보조 UI */
  .password_info{ color:var(--sub); }
  #btnTogglePw{
    appearance:none; border:1px solid var(--line); background: var(--card-2);
    color:#b9c3d4; border-radius:10px; padding:6px 10px; cursor:pointer;
    transition: background .15s ease, border-color .15s ease, color .15s ease;
  }
  #btnTogglePw:hover{ border-color:#3a4250; background:#161a22; color:#e7e9ee; }

  /* 에러 텍스트 */
  .error_text{ color: var(--danger); font-size: 13px; }

  /* select 화살표 커스텀 (웹킷 기준) */
  select.input{
    appearance:none;
    background:
      linear-gradient(180deg, transparent 0%, transparent 70%, rgba(255,255,255,.05) 100%),
      var(--card-2);
    background-image:
      linear-gradient(180deg, transparent 0%, transparent 70%, rgba(255,255,255,.05) 100%),
      var(--card-2),
      url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' viewBox='0 0 24 24' fill='none' stroke='%239aa3b2' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
    background-repeat:no-repeat;
    background-position: right 12px center;
    padding-right: 44px;
  }

  /* 라디오: 성별 / 내외국인 → 세그먼트 버튼화 */
  .adult_list{ list-style:none; padding:0; margin:0; display:flex; gap:10px; }
  .adult_list .radio input[type="radio"]{
    position:absolute; opacity:0; pointer-events:none;
  }
  .adult_list .radio label{
    display:inline-flex; align-items:center; justify-content:center;
    min-width: 90px; height: 44px; padding:0 14px; cursor:pointer;
    border:1px solid var(--line); border-radius:10px; color:#cbd5e1;
    background: var(--card-2); transition:all .15s ease;
  }
  .adult_list .radio input[type="radio"]:checked + label{
    border-color: var(--green); color:#0b1f13; background: rgba(3,199,90,.9);
    font-weight:700;
  }
  .adult_list .radio label:hover{
    border-color:#3a4250; background:#161a22;
  }

  /* 버튼 */
  .btn_submit{
    width:100%; height:56px; margin-top:6px;
    border:0; border-radius: 14px; background: var(--green);
    color:#072d18; font-weight:800; letter-spacing:.2px; font-size:18px; cursor:pointer;
    transition: transform .06s ease, background .15s ease, box-shadow .15s ease;
    box-shadow: 0 8px 24px rgba(3,199,90,.25);
  }
  .btn_submit:hover{ background: var(--green-2); }
  .btn_submit:active{ transform: translateY(1px); }

  /* 시각 숨김 */
  .blind{
    position:absolute !important; width:1px; height:1px; padding:0; margin:-1px;
    overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0;
  }

  /* 반응형 */
  @media (max-width: 560px){
    .form{ width:100%; padding:16px; }
    .logo .link{ font-size:28px; }
    .adult_list .radio label{ min-width: 0; flex:1; }
  }
</style>

</head>
<body class="bg-light">
  <div class="inner">
    <h1 class="logo naver">
      <a href="https://naver.com" class="link">NAVER</a>
    </h1>

    <div class="content">
      <!-- 폼 시작 -->
      <form id="join_form" method="get" action="/user2/join/end" class="form" novalidate>
        <!-- 서버가 사용하는 hidden 값들 -->
        <input type="hidden" id="token_sjoin" name="token_sjoin" value="kGSybP2tYlcV3yt0">
        <input type="hidden" id="nid_kb2" name="nid_kb2" value="">
        <input type="hidden" id="joinMode" name="joinMode" value="joinIdentity">
        <input type="hidden" id="encPswd" name="encPswd" value="">
        <input type="hidden" id="enckey" name="enckey" value="">
        <input type="hidden" id="telecom" name="telecom" value="">
        <input type="hidden" id="birthday" name="birthday" value="">

        <div class="form_content">
          <div class="form_section">
            <div class="join_toggle" id="divToggle">
              <input type="checkbox" id="join_toggle" checked />
              <label for="join_toggle">실명 인증된 아이디로 가입</label>
            </div>

            <div class="form_list">
              <!-- 아이디 -->
              <div class="form_item user" id="divId">
                <label for="id">아이디</label>
                <div style="display:flex; gap:6px; align-items:center;">
                  <input type="text" id="id" name="id" class="input" placeholder="아이디"
                         maxlength="20" autocapitalize="off" required
                         pattern="[a-z0-9][a-z0-9._-]{3,19}"/>
                  <div class="id_naver">@naver.com</div>
                </div>
                <div class="error_text item_style" id="idMsg" style="display:none"></div>
              </div>

              <!-- 비밀번호 -->
              <div class="form_item password" id="divPassword">
                <label for="pswd1">비밀번호</label>
                <input
                    type="password"
                    id="pswd1"
                    name="pswd1"
                    class="input"
                    placeholder="비밀번호"
                    maxlength="20"
                    autocomplete="new-password"
                    required
                    pattern="(?=.*[A-Za-z])(?=.*\d)(?=.*[^A-Za-z0-9]).{8,}"
                    title="영문, 숫자, 특수문자를 각각 1자 이상 포함해 8자 이상 입력하세요."
                />
                <div class="password_info" style="display:flex; justify-content:space-between; align-items:center;">
                    <em class="how_secure" id="secureLevel" aria-live="polite"></em>
                    <button type="button" class="btn_show" id="btnTogglePw">
                    <span class="blind">비밀번호 보기</span>보기
                    </button>
                </div>
                <div class="error_text item_style" id="pswdMsg" style="display:none"></div>
              </div>

              <!-- 이메일 -->
              <div class="form_item email" id="divEmail">
                <label for="email">[선택] 이메일 주소</label>
                <input type="email" id="email" name="email"
                       placeholder="[선택] 이메일주소 (비밀번호 찾기 등 본인 확인용)"
                       class="input" maxlength="60" />
                <div class="error_text item_style" id="emailMsg" style="display:none"></div>
              </div>
            </div>

            <div class="form_list">
              <!-- 이름 -->
              <div class="form_item user" id="divName">
                <label for="name">이름</label>
                <input type="text" id="name" name="name" placeholder="이름" class="input" maxlength="40" required />
              </div>

              <!-- 생년월일 -->
              <div class="form_item calendar" id="divBirthday">
                <label for="birthdayInput">생년월일</label>
                <input type="date" id="birthdayInput" class="input" required />
              </div>

              <!-- 통신사 -->
              <div class="form_item telecom" id="divTelecom">
                <label for="telecomSelect">통신사</label>
                <select id="telecomSelect" class="input" required>
                  <option value="">통신사 선택</option>
                  <option value="SKT">SKT</option>
                  <option value="SKT_MVNO">SKT 알뜰폰</option>
                  <option value="KT">KT</option>
                  <option value="KT_MVNO">KT 알뜰폰</option>
                  <option value="LGU">LG U+</option>
                  <option value="LGU_MVNO">LG U+ 알뜰폰</option>
                </select>
              </div>

              <!-- 성별 -->
              <div class="form_item adult" id="divIdentityGender">
                <fieldset style="border:0; padding:0; margin:0;">
                  <legend>성별</legend>
                  <ul class="adult_list" id="listIdentityGender1" style="list-style:none; padding:0; display:flex; gap:12px;">
                    <li class="radio item">
                      <input type="radio" id="identityGender1" name="identityGender" value="M" required />
                      <label for="identityGender1">남자</label>
                    </li>
                    <li class="radio item">
                      <input type="radio" id="identityGender2" name="identityGender" value="F" />
                      <label for="identityGender2">여자</label>
                    </li>
                  </ul>
                </fieldset>
              </div>

              <!-- 내/외국인 -->
              <div class="form_item nationality" id="divNationality">
                <fieldset style="border:0; padding:0; margin:0;">
                  <legend>내/외국인</legend>
                  <ul class="adult_list" id="listIdentityGender2" style="list-style:none; padding:0; display:flex; gap:12px;">
                    <li class="radio item">
                      <input type="radio" id="foreigner1" name="foreigner" value="K" required />
                      <label for="foreigner1">내국인</label>
                    </li>
                    <li class="radio item">
                      <input type="radio" id="foreigner2" name="foreigner" value="F" />
                      <label for="foreigner2">외국인</label>
                    </li>
                  </ul>
                </fieldset>
              </div>
            </div>

            <div class="form_list" id="divPhoneNoOuter">
              <!-- 휴대전화 -->
              <div class="form_item phone" id="divPhoneNo">
                <label for="phoneNo">휴대전화번호</label>
                <input type="tel" id="phoneNo" name="phoneNo" class="input" placeholder="예: 01012345678"
                       maxlength="16" inputmode="numeric" pattern="^01[0-9]{8,9}$" required />
              </div>

              <!-- 자기소개 (textarea) -->
              <div class="form_item intro" id="divIntro">
                <label for="intro">자기소개</label>
                <textarea id="intro" name="intro" class="input" rows="4" placeholder="간단한 자기소개를 입력해주세요"></textarea>
              </div>

              <!-- 학력 (select) -->
              <div class="form_item edu" id="divEdu">
                <label for="education">학력</label>
                <select id="education" name="education" class="input" required>
                  <option value="">선택하세요</option>
                  <option value="elementary">초등</option>
                  <option value="middle">중등</option>
                  <option value="high">고등</option>
                  <option value="university">대학 </option>
                </select>
              </div>
            </div>

            <div>
              <button type="submit" class="btn_submit">가입하기</button>
            </div>
          </div>
        </div>
      </form>
      <!-- 폼 끝 -->
    </div>
  </div>

  <script>
    // ====== 요소 참조 ======
    const form = document.getElementById('join_form');

    const idEl = document.getElementById('id');
    const idMsg = document.getElementById('idMsg');

    const pwEl = document.getElementById('pswd1');
    const pwMsg = document.getElementById('pswdMsg');
    const btnTogglePw = document.getElementById('btnTogglePw');
    const secureLevel = document.getElementById('secureLevel');

    const emailEl = document.getElementById('email');
    const nameEl = document.getElementById('name');

    const birthdayInput = document.getElementById('birthdayInput');
    const birthdayHidden = document.getElementById('birthday');

    const telecomSelect = document.getElementById('telecomSelect');
    const telecomHidden = document.getElementById('telecom');

    const genderRadios = document.querySelectorAll('input[name="identityGender"]');
    const natRadios = document.querySelectorAll('input[name="foreigner"]');

    const phoneEl = document.getElementById('phoneNo');

    const introEl = document.getElementById('intro');
    const eduEl = document.getElementById('education');

    const submitBtn = document.querySelector('.btn_submit');

    // ====== 유틸 ======
    const show = (el, msg='') => { if (!el) return; el.style.display='block'; el.textContent = msg; };
    const hide = (el) => { if (!el) return; el.style.display='none'; el.textContent=''; };

    const isRadioChecked = (nodeList) => [...nodeList].some(r => r.checked);

    // ====== 각 필드 검증 ======
    function validateId() {
      const v = idEl.value.trim();
      // HTML pattern과 동일한 조건 재확인
      const ok = /^[a-z0-9][a-z0-9._-]{3,19}$/.test(v);
      if (!ok) {
        show(idMsg, '아이디는 영소문자/숫자로 시작하며 4~20자, 특수문자는 . _ - 만 허용됩니다.');
      } else {
        hide(idMsg);
      }
      return ok;
    }

    function validatePassword() {
      const v = pwEl.value;
      const ok = /(?=.*[A-Za-z])(?=.*\d)(?=.*[^A-Za-z0-9]).{8,}/.test(v);
      if (!ok) {
        show(pwMsg, '영문, 숫자, 특수문자를 각각 1자 이상 포함해 8자 이상 입력하세요.');
      } else {
        hide(pwMsg);
      }
      return ok;
    }

    function validateEmail() {
      const v = emailEl.value.trim();
      if (v === '') return true; // 선택 입력
      // 브라우저의 기본 email 검증을 보조
      const ok = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
      if (!ok) alert('이메일 형식을 확인하세요.');
      return ok;
    }

    function validateName() {
      const ok = nameEl.value.trim().length > 1;
      if (!ok) alert('이름을 2자 이상 입력하세요.');
      return ok;
    }

    function validateBirthday() {
      const v = birthdayInput.value; // yyyy-mm-dd
      if (!v) { alert('생년월일을 선택하세요.'); return false; }

      // 나이 14세 이상 제한 예시
      const today = new Date();
      const b = new Date(v);
      let age = today.getFullYear() - b.getFullYear();
      const m = today.getMonth() - b.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < b.getDate())) age--;

      if (isNaN(b.getTime())) { alert('유효한 생년월일이 아닙니다.'); return false; }
      if (age < 14) { alert('만 14세 미만은 가입할 수 없습니다.'); return false; }
      return true;
    }

    function validateTelecom() {
      if (!telecomSelect.value) { alert('통신사를 선택하세요.'); return false; }
      return true;
    }

    function validateGender() {
      if (!isRadioChecked(genderRadios)) { alert('성별을 선택하세요.'); return false; }
      return true;
    }

    function validateNationality() {
      if (!isRadioChecked(natRadios)) { alert('내/외국인을 선택하세요.'); return false; }
      return true;
    }

    function validatePhone() {
      const ok = /^01[0-9]{8,9}$/.test(phoneEl.value.trim());
      if (!ok) alert('휴대전화번호 형식을 확인하세요. 예: 01012345678');
      return ok;
    }

    function validateIntro() {
      // 예: 300자 제한
      if (introEl.value.length > 300) {
        alert('자기소개는 300자 이내로 입력하세요.');
        return false;
      }
      return true;
    }

    function validateEdu() {
      if (!eduEl.value) { alert('학력을 선택하세요.'); return false; }
      return true;
    }

    function validateAll() {
      // 순서대로 검증하며, 실패 시 즉시 중단
      if (!validateId()) return false;
      if (!validatePassword()) return false;
      if (!validateEmail()) return false;
      if (!validateName()) return false;
      if (!validateBirthday()) return false;
      if (!validateTelecom()) return false;
      if (!validateGender()) return false;
      if (!validateNationality()) return false;
      if (!validatePhone()) return false;
      if (!validateIntro()) return false;
      if (!validateEdu()) return false;
      return true;
      }

    // onchange: 값 변경 시 즉시 검증/동기화
    idEl.onchange = validateId;
    pwEl.onchange = validatePassword;
    emailEl.onchange = validateEmail;
    nameEl.onchange = validateName;

    birthdayInput.onchange = () => {
      birthdayHidden.value = birthdayInput.value;  // hidden 동기화
      validateBirthday();
    };

    telecomSelect.onchange = () => {
      telecomHidden.value = telecomSelect.value;   // hidden 동기화
      validateTelecom();
    };

    eduEl.onchange = validateEdu;
    phoneEl.onchange = validatePhone;
    introEl.onchange = validateIntro;

    // onkeydown: 입력 제한(공백/특수 입력 방지 등)
    idEl.onkeydown = (e) => {
      // 아이디에 공백 금지
      if (e.key === ' ') e.preventDefault();
    };
    pwEl.onkeydown = (e) => {
      // 비밀번호에 공백 금지
      if (e.key === ' ') e.preventDefault();
    };
    phoneEl.onkeydown = (e) => {
      // 숫자, 편집키만 허용
      const allow = ['Backspace','Delete','Tab','ArrowLeft','ArrowRight','Home','End','Enter'];
      if (allow.includes(e.key)) return;
      if (!/^[0-9]$/.test(e.key)) e.preventDefault();
    };

    // 비밀번호 강도 표시(기존 로직 유지)
    pwEl.addEventListener('input', () => {
      const val = pwEl.value;
      let score = 0;
      if (val.length >= 8) score++;
      if (/[A-Z]/.test(val)) score++;
      if (/[a-z]/.test(val)) score++;
      if (/\d/.test(val)) score++;
      if (/[^A-Za-z0-9]/.test(val)) score++;
      const text = ['약함', '보통', '좋음', '강함', '매우 강함'];
      secureLevel.textContent = text[Math.min(score-1, text.length-1)] || '';
    });

    // onclick: 제출 전 전체 검증 + confirm
    submitBtn.onclick = (e) => {
      if (!validateAll()) {
        e.preventDefault();
        return;
      }
      // 마지막 확인
      if (!confirm('입력한 정보로 인증요청을 진행할까요?')) {
        e.preventDefault();
      }
    };

    // onmouseover / onmouseout: 제출 버튼 힌트(예시로 title 변경)
    submitBtn.onmouseover = () => submitBtn.title = '클릭하면 제출 전 최종 확인이 뜹니다.';
    submitBtn.onmouseout  = () => submitBtn.title = '';

    // 보기/숨기기(기존)
    btnTogglePw.addEventListener('click', function () {
      pwEl.type = (pwEl.type === 'password') ? 'text' : 'password';
      this.textContent = (pwEl.type === 'password') ? '보기' : '숨기기';
    });

    // form 자체의 submit 이벤트는 기본 HTML5 checkValidity 보조용으로만 유지
    form.addEventListener('submit', function (e) {
      // hidden 값 최종 보정
      birthdayHidden.value = birthdayInput.value;
      telecomHidden.value = telecomSelect.value;

      if (!form.checkValidity()) {
        e.preventDefault();
        alert('필수 항목을 확인해 주세요.');
      }
    });
  </script>
</body>
</html>
